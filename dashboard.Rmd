---
title: "Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(plotly)
library(p8105.datasets)

data("ny_noaa")

ny_noaa = 
  ny_noaa |> 
  drop_na() |> 
  filter(date >= as.Date("2008-01-01"), date <= as.Date("2010-12-31")) |> 
  filter(id == "USW00094728") |> 
  mutate(tmin = as.numeric(tmin), tmax = as.numeric(tmax), tmin = tmin / 10, tmax = tmax / 10) |> 
  mutate(name = "Central Park",
         month = lubridate::floor_date(date, unit = "month")) |> 
  select(name, everything())
```

Column {data-width=650}
-----------------------------------------------------------------------

### Chart A

```{r}
ny_noaa |> 
  plot_ly(x = ~tmax, y = ~tmin, type = "scatter", mode = "markers", 
          marker = list(opacity = 0.5)) |> 
  layout(title = "Temperature Plot for Central Park Between 2008 and 2010",
    xaxis = list(title = "Minimum daily temperature (C)"),
    yaxis = list(title = "Maximum daily temperature (C)"),
    legend = list(x = 1, y = 1))
```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}
ny_noaa |>
  group_by(month) |>
  summarize(mean_tmax = mean(tmax)) |>
  plot_ly(x = ~month, y = ~mean_tmax, type = "scatter", mode = "lines+markers") |>
  layout(title = "Average Max Temperature for Central Park Between 2008 and 2010",
    xaxis = list(title = "Month"),
    yaxis = list(title = "Average maximum temperature (C)"))
  
```

### Chart C

```{r}
ny_noaa |>
  filter(prcp > 0) |>
  plot_ly(x = ~prcp, type = "histogram", histnorm = "probability", opacity = 0.5) |>
  layout(title = "Density Plot of Precipitation for Central Park Between 2008 and 2010",
    xaxis = list(title = "Precipitation (tenths of mm)"),
    yaxis = list(title = "Density"))
```

